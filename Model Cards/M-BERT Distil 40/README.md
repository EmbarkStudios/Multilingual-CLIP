<br />
<p align="center">
  <h1 align="center">M-BERT Distil 40</h1>
  
  <p align="center">  
    <a href="https://huggingface.co/M-CLIP/M-BERT-Distil-40">Huggingface Model</a>
    Â·
    <a href="https://huggingface.co/distilbert-base-multilingual-cased">Huggingface Base Model</a>
  </p>
</p>


<!-- ABOUT THE PROJECT -->
## About
A [distilbert-base-multilingual](https://huggingface.co/distilbert-base-multilingual-cased) tuned to match the embedding space for 40 languages, to the embedding space of the CLIP text encoder which accomponies the Res50x4 vision encoder.
A full list of the languages which were used during fine-tuning can be found at [the end of this page](#supported-languages).

Training data pairs was generated by sampling 40k sentences for each language from the combined descriptions of [GCC](https://ai.google.com/research/ConceptualCaptions/) + [MSCOCO](https://cocodataset.org/#home) + [VizWiz](https://vizwiz.org/tasks-and-datasets/image-captioning/), and translating them into the corresponding language.
All translation was done using the [AWS translate service](https://aws.amazon.com/translate/), the quality of these translations have currently not been analyzed, but one can assume the quality varies between the 40 languages.


## Evaluation
A non-rigirous qualitative evaluation show that for the languages French, German, Spanish, Russian, Swedish and Greek it seemingly yields respectable results for most instances. However, it was found that Kannada performed close to random, although it was included during fine-tuning.

The qualitative test in which  was organized into two sets of images and their corresponding text descriptions. The texts were manually translated into the different test languages, where the two sets include the following images:
#### Set Nr 1
* A man on a motorcyckle
* A green apple
* A bowl of fruits
* A bunch of bananas hanging from a tree
* A happy person luaghing/smiling
* A sad person crying
#### Set Nr 2
The second set included only images of fruits, and non-realistic photoshoped images, in an attempt to increase the difficlulty.
* A green apple
* A red apple
* A purple apple (photoshoped)
* A orange apple (photoshoped)
* A bowl of fruits
* A bunch of bananas hanging from a tree

### Results
The results depicted below are formated so that each <b>colum</b> represents the Softmax prediction over all the texts given the corresponding image. The images and matchings texts are ordered identicaly, hence a perfect solution would have 100 across the diagonal.

#### French
![Alt](./French-Both.png)
#### German
![Alt](./German-Both.png)
#### Spanish
![Alt](./Spanish-Both.png)
#### Russian
![Alt](./Russian-Both.png)
#### Swedish
![Alt](./M-Swedish-Both.png)
#### Greek
![Alt](./Greek-Both.png)
#### Kannada
![Alt](./Kannada-Both.png)

